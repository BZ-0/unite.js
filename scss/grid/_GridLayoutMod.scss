@use "../core/ClassMods" as cm;
@use "../core/Logic" as lg;

//
@property --inline-offset-iv { syntax: "<length-percentage>"; initial-value: 0px; inherits: true; }
@property --inline-offset-ni { syntax: "<length-percentage>"; initial-value: 0px; inherits: true; }
@property --inline-offset    { syntax: "<length-percentage>"; initial-value: 0px; inherits: true; }

//
@property --block-offset-iv { syntax: "<length-percentage>"; initial-value: 0px; inherits: true; }
@property --block-offset-ni { syntax: "<length-percentage>"; initial-value: 0px; inherits: true; }
@property --block-offset    { syntax: "<length-percentage>"; initial-value: 0px; inherits: true; }

//
@property --ox-columns { syntax: "<integer>"; initial-value: 0; inherits: true; }
@property --ox-rows    { syntax: "<integer>"; initial-value: 0; inherits: true; }

//
@property --ox-orient { syntax: "<integer>"; initial-value: 0; inherits: true; }

//
@property --ox-column { syntax: "<number>"; initial-value: 0; inherits: true; }
@property --ox-row    { syntax: "<number>"; initial-value: 0; inherits: true; }

//
@property --ox-col-size { syntax: "<length-percentage>"; initial-value: 0px; inherits: true; }
@property --ox-row-size { syntax: "<length-percentage>"; initial-value: 0px; inherits: true; }

//
@layer ux-grid-layout {

    //
    @supports not (display: layout(grid-page)) {
        .ux-grid-layout {
            //
            display: block;
            position: relative;

            //
            --ox-orient: rem(var(--orient), 2);
            --ox-columns: #{lg.mix(var(--rows), var(--columns), var(--ox-orient))};
            --ox-rows: #{lg.mix(var(--columns), var(--rows), var(--ox-orient))};

            //
            & > :where(*) {
                will-change: transform, inset, --ox-column, --ox-row, --grid-column, --grid-row, --translate-x, --translate-y;

                //
                --ox-column: calc(#{lg.mix(var(--grid-row), var(--grid-column), var(--ox-orient))} - 1);
                --ox-row: calc(#{lg.mix(var(--grid-column), var(--grid-row), var(--ox-orient))} - 1);

                //
                --ox-col-size: calc(100cqi / var(--ox-columns));
                --ox-row-size: calc(100cqb / var(--ox-rows));

                //
                --inline-offset-ni: calc(var(--ox-column) * var(--ox-col-size));
                --inline-offset-iv: calc(calc(var(--ox-columns) - var(--ox-column) - 1) * var(--ox-col-size));
                --inline-offset: #{lg.mix(
                    var(--inline-offset-ni),
                    var(--inline-offset-iv),
                    lg.lor(lg.eq(var(--orient), 0), lg.eq(var(--orient), 1))
                )};

                //
                --block-offset-ni: calc(var(--ox-row) * var(--ox-row-size));
                --block-offset-iv: calc(calc(var(--ox-rows) - var(--ox-row) - 1) * var(--ox-row-size));
                --block-offset: #{lg.mix(
                    var(--block-offset-ni),
                    var(--block-offset-iv),
                    lg.lor(lg.eq(var(--orient), 0), lg.eq(var(--orient), 3))
                )};

                //
                position: absolute;

                //
                inset-inline-start: calc(var(--inline-offset, 0px) + var(--ox-col-size) / 2);
                inset-block-start: calc(var(--block-offset, 0px) + var(--ox-row-size) / 2);
                inset-inline-end: auto;
                inset-block-end: auto;

                //
                transform: translate3d(
                    calc(var(--translate-x) - 50%),
                    calc(var(--translate-y) - 50%),
                    0px);
            }
        }
    }

}
