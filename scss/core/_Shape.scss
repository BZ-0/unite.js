@use '@sass-fairy/list';

// if you don't want to use deps...
@function join($list, $glue: '', $is-nested: false) {
    $result: null;
    @for $i from 1 through length($list) {
        $e: nth($list, $i);
        @if type-of($e) == list {
            $result: $result#{join($e, $glue, true)};
        } @else {
            $result: if(
                $i != length($list) or $is-nested,
                $result#{$e}#{$glue},
                $result#{$e}
            );
        }
    }
    @return $result;
};

// F(X):[x,y] where X:[0..1]
@function WavyFx($step: 0) {
    $angle: calc(#{$step}rad * #{"pi"} * 2);
    $variant: calc(calc(cos(calc(var(--clip-freq) * #{$angle})) * 0.5 + 0.5) * var(--clip-amplitude));
    $x: calc(calc(0.5 + calc(cos(#{$angle}) * calc(0.5 - #{$variant}))) * 100%);
    $y: calc(calc(0.5 + calc(sin(#{$angle}) * calc(0.5 - #{$variant}))) * 100%);
    @return "#{$x} #{$y}";
}

// space cadet or cheater-tale
@function Integrate($name, $steps: 100) {
    $fx: get-function($name);
    $points: ();
    @for $i from 1 through $steps {
        $points: append($points, call($fx, $step: $i / $steps));
    }
    @return polygon(#{list.join($points, ", ")});
}

//
:where(.wavy-shaped) {
    --clip-amplitude: 0.06;
    --clip-freq: 8;
    --clip-path: #{Integrate("WavyFx", 100)};
}
